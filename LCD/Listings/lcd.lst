C51 COMPILER V9.59.0.0   LCD                                                               08/11/2025 15:51:37 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE LCD
OBJECT MODULE PLACED IN .\Objects\lcd.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE lcd.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\lcd.l
                    -st) TABS(2) OBJECT(.\Objects\lcd.obj)

line level    source

   1          #include <reg51.h>
   2          
   3          #define lcd_data P1
   4          #define keypad   P0
   5          
   6          sbit RS = P2^0;
   7          sbit RW = P2^1;
   8          sbit EN = P2^2;
   9          
  10          char key_map[4][4] = {
  11            {'0','1','2','3'},
  12            {'4','5','6','7'},
  13            {'8','9','A','B'},
  14            {'C','D','E','F'}
  15          };
  16          
  17          void delay(unsigned int ms) {
  18   1        unsigned int i, j;
  19   1        for(i = 0; i < ms; i++)
  20   1          for(j = 0; j < 1275; j++);
  21   1      }
  22          
  23          void lcd_cmd(unsigned char cmd) {
  24   1        RS = 0; RW = 0;
  25   1        lcd_data = cmd;
  26   1        EN = 1; delay(2); EN = 0;
  27   1      }
  28          
  29          void lcd_char(unsigned char val) {
  30   1        RS = 1; RW = 0;
  31   1        lcd_data = val;
  32   1        EN = 1; delay(2); EN = 0;
  33   1      }
  34          
  35          void lcd_string(char *s) {
  36   1        while(*s) {
  37   2          lcd_char(*s++);
  38   2        }
  39   1      }
  40          
  41          void lcd_init() {
  42   1        lcd_cmd(0x38);
  43   1        lcd_cmd(0x0C);
  44   1        lcd_cmd(0x01);
  45   1        lcd_cmd(0x80);
  46   1      }
  47          
  48          char get_key() {
  49   1        unsigned char row, col;
  50   1        for(row = 0; row < 4; row++) {
  51   2          keypad = 0xFF;
  52   2          keypad &= ~(1 << row);
  53   2          delay(1);
  54   2          for(col = 0; col < 4; col++) {
C51 COMPILER V9.59.0.0   LCD                                                               08/11/2025 15:51:37 PAGE 2   

  55   3            if(!(keypad & (1 << (4 + col)))) {
  56   4              delay(20);
  57   4              while(!(keypad & (1 << (4 + col))));
  58   4              return key_map[row][col];
  59   4            }
  60   3          }
  61   2        }
  62   1        return 0;
  63   1      }
  64          
  65          void main() {
  66   1        char key;
  67   1        lcd_init();
  68   1        lcd_cmd(0x80);
  69   1        lcd_string("pressed value is:");
  70   1        while(1) {
  71   2          key = get_key();
  72   2          if(key) {
  73   3            lcd_cmd(0xC0);   
  74   3            lcd_char(key);
  75   3            delay(500);
  76   3          }
  77   2        }
  78   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    295    ----
   CONSTANT SIZE    =     18    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     16       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
