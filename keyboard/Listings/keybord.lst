C51 COMPILER V9.59.0.0   KEYBORD                                                           08/11/2025 15:49:18 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE KEYBORD
OBJECT MODULE PLACED IN .\Objects\keybord.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE keybord.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\k
                    -eybord.lst) TABS(2) OBJECT(.\Objects\keybord.obj)

line level    source

   1          #include <reg51.h>
   2          
   3          #define seg P1       
   4          #define keys P0     
   5          
   6          
   7          sbit c1 = P2^0;
   8          sbit c2 = P2^1;
   9          sbit c3 = P2^2;
  10          sbit c4 = P2^3;
  11          
  12          
  13          unsigned char seg_code[16] = {0xC0, 0xF9, 0xA4, 0xB0, 0x99, 0x92, 0x82, 0xF8, 0x80, 0x90, 0x88, 0x83,0xC6,
             - 0xA1, 0x86, 0x8E };
  14          
  15          
  16          unsigned char key_map[4][4] = {
  17            {0x0, 0x1, 0x2, 0x3},
  18            {0x4, 0x5, 0x6, 0x7},
  19            {0x8, 0x9, 0xA, 0xB},
  20            {0xC, 0xD, 0xE, 0xF}
  21          };
  22          
  23          void delay(unsigned int ms) {
  24   1        unsigned int i, j;
  25   1        for(i = 0; i < ms; i++)
  26   1          for(j = 0; j < 1275; j++);
  27   1      }
  28          
  29          
  30          unsigned char get_key() {
  31   1        unsigned char row, col;
  32   1        
  33   1        for(row = 0; row < 4; row++) {
  34   2          keys = 0xFF; 
  35   2          keys &= ~(1 << row); 
  36   2      
  37   2          delay(2); 
  38   2      
  39   2          for(col = 0; col < 4; col++) {
  40   3            if((keys & (0x10 << col)) == 0) { 
  41   4              delay(20); 
  42   4              while((keys & (0x10 << col)) == 0); 
  43   4              return key_map[row][col]; 
  44   4         }
  45   3        }
  46   2        }
  47   1        
  48   1        return 0xFF; 
  49   1      }
  50          
  51          
  52          void display(unsigned char val) {
  53   1        seg = seg_code[val];
C51 COMPILER V9.59.0.0   KEYBORD                                                           08/11/2025 15:49:18 PAGE 2   

  54   1      
  55   1        c1 = c2 = c3 = c4 = 0;  
  56   1        delay(5);                           
  57   1        c1 = c2 = c3 = c4 = 1; 
  58   1      }
  59          
  60          void main() {
  61   1        unsigned char key;
  62   1      
  63   1        c1 = c2 = c3 = c4 = 1; 
  64   1        seg = 0xFF;                       
  65   1      
  66   1        while(1) {
  67   2          key = get_key();
  68   2      
  69   2          if(key != 0xFF && key < 16) {
  70   3            display(key); 
  71   3          }
  72   2        }
  73   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    225    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     32       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
